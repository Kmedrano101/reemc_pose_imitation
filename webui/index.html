<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />

<script type="text/javascript" src="http://static.robotwebtools.org/EventEmitter2/current/eventemitter2.min.js"></script>
<script type="text/javascript" src="http://static.robotwebtools.org/roslibjs/current/roslib.min.js"></script>

<script type="text/javascript" type="text/javascript">
  // Connecting to ROS
  // -----------------

    var ros = new ROSLIB.Ros({
        url : 'ws://localhost:9090'
    });

    ros.on('connection', function() {
        console.log('Connected to websocket server.');
    });

    ros.on('error', function(error) {
        console.log('Error connecting to websocket server: ', error);
    });

    ros.on('close', function() {
        console.log('Connection to websocket server closed.');
    });

  // Publishing a Topic
  // ------------------

    var cmdVel = new ROSLIB.Topic({
        ros : ros,
        name : '/cmd_vel',
        messageType : 'geometry_msgs/Twist'
    });

    var twist = new ROSLIB.Message({
        linear : {
            x : 0.1,
            y : 0.2,
            z : 0.3
        },
        angular : {
            x : -0.1,
            y : -0.2,
            z : -0.3
        }
    });
    cmdVel.publish(twist);

  // Subscribing to a Topic
  // ----------------------
    var imageTopic = new ROSLIB.Topic({
        ros : ros,
        name : '/usb_cam/image_raw/compressed',
        messageType : 'sensor_msgs/CompressedImage'
    });

    imageTopic.subscribe(function(message) {
        document.getElementById('my_image').src = "data:image/jpg;base64," + message.data;
        listener.unsubscribe();
    });

    var listener = new ROSLIB.Topic({
        ros : ros,
        name : '/listener',
        messageType : 'std_msgs/String'
    });

    listener.subscribe(function(message) {
        console.log('Received message on ' + listener.name + ': ' + message.data);
        listener.unsubscribe();
    });

  // Getting and setting a param value
  // ---------------------------------

    ros.getParams(function(params) {
        console.log(params);
    });

    var points = new ROSLIB.Param({
        ros : ros,
        name : '/web_points/points'
    });
    
    function sendValues(){ 
        const values = [];
        values[0] = parseFloat(document.getElementById('joint_1').value)
        values[1] = parseFloat(document.getElementById('joint_2').value)
        values[2] = parseFloat(document.getElementById('joint_3').value)
        values[3] = parseFloat(document.getElementById('joint_4').value)
        values[4] = parseFloat(document.getElementById('joint_5').value)
        values[5] = parseFloat(document.getElementById('joint_6').value)
        values[6] = parseFloat(document.getElementById('joint_7').value)
        values[7] = parseFloat(document.getElementById('joint_8').value)
        values[8] = parseFloat(document.getElementById('joint_9').value)
        values[9] = parseFloat(document.getElementById('joint_10').value)
        values[10] = parseFloat(document.getElementById('joint_11').value)
        values[11] = parseFloat(document.getElementById('joint_12').value)
        values[12] = parseFloat(document.getElementById('joint_13').value)
        values[13] = parseFloat(document.getElementById('joint_14').value)
        values[14] = parseFloat(document.getElementById('joint_15').value)
        values[15] = parseFloat(document.getElementById('joint_16').value)
        values[16] = parseFloat(document.getElementById('joint_17').value)
        values[17] = parseFloat(document.getElementById('joint_18').value)
        points.set(values);
        console.log(values)
    }
</script>
</head>

<body>
    <h1>Reem-c Pose Imitation</h1>
    <p>Imagen</p>
    <img id="my_image" style='height: 320; width: 640; object-fit: contain' src="">
    <h1>Joints to move</h1>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_1" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_2" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_3" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_4" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_5" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_6" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_7" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_8" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_9" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_10" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_11" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_12" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_13" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_14" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_15" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_16" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_17" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <div>
        <label for="volume">Joint</label>
        <input type="range" id="joint_18" name="Joint_X"
            min="-3.0" max="3.0" step="0.1" oninput="this.nextElementSibling.value = this.value">
        <output></output>
    </div>
    <button style="padding: 12px 70px;" type="button" onclick="sendValues()">Send Points</button> 

</body>
</html>